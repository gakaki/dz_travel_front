<!--pages/rank/rank.wxml-->
<view class="con">
  <view class="head f-r-sa">
    <image class="rank-title" src="https://gengxin.odao.com/update/h5/travel/rank/score-rank.png" hidden='{{!(rankType==3)}}' bindtap='lookScore'></image>
    <image class="rank-title" src="https://gengxin.odao.com/update/h5/travel/rank/score-rank-gray.png" hidden='{{rankType==3}}' bindtap='lookScore'></image>
    <image class="rank-title" src="https://gengxin.odao.com/update/h5/travel/rank/foot-rank.png" hidden='{{!(rankType==2)}}' bindtap='lookFoot'></image>
    <image class="rank-title" src="https://gengxin.odao.com/update/h5/travel/rank/foot-rank-gray.png" hidden='{{rankType==2}}' bindtap='lookFoot'></image>
    <image class="rank-title" src="https://gengxin.odao.com/update/h5/travel/rank/famous-rank.png" hidden='{{!(rankType==1)}}' bindtap='lookFamous'></image>
    <image class="rank-title" src="https://gengxin.odao.com/update/h5/travel/rank/famous-rank-gray.png" hidden='{{rankType==1}}' bindtap='lookFamous'></image>
  </view>
  <view class="rank-head flex">
    <view class="rank-item {{rankSubtype==1 ? 'rank-choose' : ''}}" bindtap='rankCountry'>全国排行榜</view>
    <view class="rank-item {{rankSubtype==1 ? '' : 'rank-choose'}}" bindtap='rankFriend'>好友排行榜</view>
  </view>
  <view class="top-three flex {{topThree.length==2 ? 'flex-left' : ''}}" wx:if="{{rankSubtype==1 && topThree.length}}">
    <image class="help" src="https://gengxin.odao.com/update/h5/travel/rank/tip.png" bindtap='showHelp'></image> 
    <view class="{{index==0 ? 'first' : '' || index==1 ? 'second' : '' || index==2 ? 'third' : ''}}" wx:for="{{topThree}}" wx:key="{{index}}">
      <view class="mark">{{item.rank}}</view>
      <image class="avatar" src="{{item.userInfo.avatarUrl}}" bindtap='toOther' data-uid="{{item.userInfo.uid}}"></image>
      <view class="nickname">
        <text>{{item.userInfo.nickName}}</text> 
      </view>
      <view class="info f-r-sb">
        <view class="rank-info f-r-sb">
          <image class="famous-icon" wx:if='{{rankType==3}}' src="https://gengxin.odao.com/update/h5/travel/rank/score-small.png"></image>
          <text wx:else>本周</text>
          <text>{{rankType==3 ? item.achievement : item.weekAchievement}}</text>
        </view>
        <view class="xian" wx:if="{{!noReward}}"></view>
        <view class="gold f-r-sb" wx:if="{{!noReward}}">
          <text>历史{{item.achievement}}</text>
        </view>
      </view>
    </view>
  </view>
  <scroll-view scroll-y class="rank-other {{rankSubtype==1 ? '' : 'friend'}}" scroll-into-view="{{toView}}" bindscrolltolower="getNextPage" lower-threshold="100">
    <view id="rank{{index}}" class="person-info f-r-sb" wx:for="{{rankSubtype==1 ? rankingCountry : rankingFriend}}" wx:key="{{index}}">
      <view class="f-r-sb">
        <text class="ranking">{{item.rank}}</text>
        <image class="avatar" src="{{item.userInfo.avatarUrl}}" bindtap='toOther' data-uid="{{item.userInfo.uid}}"></image>
        <text class="name">{{item.userInfo.nickName}}</text> 
      </view>
      <view class="align-start f-c-fs">
        <view class="ranking-info f-r-sb" wx:if="{{rankSubtype==1}}">
          <image class="famousing-icon" wx:if='{{rankType==3}}' src="https://gengxin.odao.com/update/h5/travel/rank/score.png"></image>
          <text wx:else>本周</text>
          <text>{{rankType==3 ? item.achievement : item.weekAchievement}}</text>
        </view>
        <view class="ranking-info f-r-sb" wx:else>
          <image class="famousing-icon" wx:if='{{rankType==1}}' src="https://gengxin.odao.com/update/h5/travel/rank/famous.png"></image>
          <image class="ranking-icon" wx:elif='{{rankType==2}}' src="https://gengxin.odao.com/update/h5/travel/rank/foot.png"></image>
          <image class="scoreing-icon" wx:else src="https://gengxin.odao.com/update/h5/travel/rank/score.png"></image>
          <text>{{item.achievement}}{{percent ? '%' : ''}}</text>
        </view>
        <view class="person-gold f-r-sb" wx:if="{{!noReward}}">
          <text>历史{{item.achievement}}{{percent ? '%' : ''}}</text>
        </view>
      </view>
    </view>
  </scroll-view>
  <view class="self-info f-r-sb">
    <view class="self-ranking">
      <text>我的排名</text>
      <text>{{selfRank.rank==0 ? '未上榜' : selfRank.rank}}</text>
    </view>
    
    <view class="f-r-sb">
      <view class="ranking-info f-c-fs self-start" wx:if="{{rankSubtype==1}}">
        <view class="flex">
          <image class="self-score" wx:if='{{rankType==3}}' src="https://gengxin.odao.com/update/h5/travel/rank/score-big.png"></image>
          <text wx:else>本周</text>
          <text>{{rankType==3 ? selfRank.achievement : selfRank.weekAchievement}}{{percent ? '%' : ''}}</text>
        </view>
        <view wx:if="{{rankType!=3}}" class="self-history">
          <text>历史{{selfRank.achievement}}{{percent ? '%' : ''}}</text>
        </view>
      </view>
      <view class="ranking-info f-r-sb" wx:else>
        <image class="self-famous" wx:if='{{rankType==1}}' src="https://gengxin.odao.com/update/h5/travel/rank/famous-big.png"></image>
        <image class="self-icon" wx:elif='{{rankType==2}}' src="https://gengxin.odao.com/update/h5/travel/rank/foot-big.png"></image>
        <image class="self-score" wx:else src="https://gengxin.odao.com/update/h5/travel/rank/score-big.png"></image>
        <text>{{selfRank.achievement}}{{percent ? '%' : ''}}</text>
      </view>
      <view class="share">
        炫耀排名
        <button open-type='share' class="share-btn"></button>
      </view>
    </view>
  </view>
  <image class="cut-off" src="https://gengxin.odao.com/update/h5/travel/index/separatrix.png"></image>
  <view class="f-c no-rank" wx:if="{{noRank && !isFriend}}">
    <image class="help no-rank-help" src="https://gengxin.odao.com/update/h5/travel/rank/tip.png" bindtap='showHelp'></image>
    <image class="no-rank-icon" src="https://gengxin.odao.com/update/h5/travel/rank/no-rank.png"></image>
    <view class="tip-con">暂无排名</view>
    <view class="up-time">排行榜每日23:30更新</view>
  </view>

  <view class="tips f-c" wx:if="{{isFirst}}">
    <image class="piaodai-left" src="https://gengxin.odao.com/update/h5/travel/index/sidai-zuo.png"></image>
    <image class="piaodai-right" src="https://gengxin.odao.com/update/h5/travel/index/sidai-right.png"></image>
    <image class="area" src="https://gengxin.odao.com/update/h5/travel/index/area.png"></image>
    <view class="welcome">
      欢迎来到<text class="welcome-name">点亮足迹</text>
    </view>
    <view class="free single font">
      首次起飞机票<text>免费</text>  
    </view>
    <view class="free double font">
      首次双人旅行机票<text>免费</text>
    </view>
    <view class="btn-fly" bindtap='toFly'>
      起飞旅行
    </view>
  </view>
  <view class="mask" wx:if="{{isFirst || showHelp}}"></view>
  <directions bind:confirm="_hide" wx:if="{{showHelp}}" resHeight="880" helpId="{{id}}" title="{{title}}"></directions>
</view>
