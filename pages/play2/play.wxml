<!--pages/play2/play.wxml-->
<view>
    <!--地图-->
    <scroll-view id="play-map" scroll-x="{{true}}" scroll-y="{{true}}" >
        <!--背景地图-->
        <image src='{{mapBg}}' style='position:absolute;top:0;left:0; height:{{ mapHeight * scale * scale}}rpx; width:{{ mapWidth * scale * scale}}rpx'></image>
        <!--虚线路径-->
        <view class="play-dash-line" wx:for="{{ dashLines }}" wx:key="{{index}}" style="position:absolute;left:{{item.x * scale}}rpx;top:{{item.y * scale}}rpx;width:{{item.wd}}rpx;transform:translateY(-4rpx) rotate({{item.rotation}}deg)"></view>
        <!--实线路径-->
        <view class="play-solid-line" wx:for="{{ solidLines }}" wx:key="{{index}}" style="position:absolute;left:{{item.x * scale}}rpx;top:{{item.y * scale}}rpx;width:{{item.wd}}rpx;transform:translateY(-4rpx) rotate({{item.rotation}}deg)"></view>
        <!--景点-->
        <view class="play-spots" wx:for="{{ spots }}" wx:key="{{index}}" data-sid="{{item.id}}" bind:tap="tapSpot" style="position:absolute;left:{{item.x * scale}}rpx;top:{{item.y * scale}}rpx;width:{{item.wd}}rpx;">
            <image class="play-spot-img" src="{{item.tracked ? item.img2 : item.img1}}"></image>
            <text class="play-spot-txt">{{item.name}}</text>
        </view>
        <!--小人-->
        <view wx:for="{{roles}}" wx:key="{{index}}" class="play-role {{item.walk ? 'walk' : 'stand' }}" style="background-image: url({{item.img}});position:absolute;left:{{item.x * scale}}rpx;top:{{item.y * scale}}rpx;transform:rotate({{item.rotation}}deg)">
            <image class="role-event-img" wx:if="{{unreadEventCnt > 0}}" src="{{eventTipImg}}"></image>
        </view>
    </scroll-view>
    <!--控件-固定-->
    <view id="play-control-normal">
        <!-- 缩放按钮  -->
        <view class="zoomBtn f-r-sa">
            <view class="add" catchtap="zoomplus"></view>
            <view class="minus" catchtap="zoomminus"></view>
        </view>
    </view>
    <!--控件-游玩中-->
    <view id="play-control-playing" wx:if="{{started}}">
        <image wx:if="{{weather.length>0}}" class="weather" src="https://gengxin.odao.com/update/h5/travel/weather/{{weather}}.png"></image>
        <!-- 提示 -->
        <view class="tip" bindtap='popPlayIntro'></view>
        <!-- 屏幕边缘按钮 -->
        <view class="mission f-c-fs" bindtap='popMissionInfo'>
            <text class="fontWhite missionText font font26">任务</text>
            <view class="progressBox">
                <view class="progressBar" style="width:{{taskPer}}rpx;"></view>
            </view>
        </view>
        <view class="changeLine f-c-fs" bindtap='chgLine' >
            <text class="fontWhite changeLineText font font26">修改路线</text>
            <text class="fontWhite changeLineMoney font font26">$100</text>
        </view>
        <!-- 按钮组 -->
        <view class="btnBoxWrap f-c-fs">

            <!-- 三个按钮 -->
            <view class="btnBox f-r-sa">
                <view class="travelTips font fontWhite font28" catchtap="toPr">旅行攻略</view>
                <view class="travelStart font fontWhite  font32" wx:if="{{!hasPath}}">规划路线</view>
                <view class="travelStart font fontWhite  font32" wx:else>正在游玩</view>
                <view class="tarvelProps font fontWhite font28" catchtap="toProps">旅行道具</view>
            </view>
            <!-- 虚拟地图警告 -->
            <view class="warningBox"></view>
        </view>
    </view>
    <!--控件-规划路线-->
    <view id="play-control-editing" wx:else >
        <view class="travelTips font fontWhite font28" catchtap="sendPath">开始游玩</view>
    </view>

    <!--<directions helpId="2" resHeight="980" wx:if="{{showIntro}}" title="玩法介绍" bind:confirm='hidePlayIntro'></directions>-->

    <!--弹出层-->
    <view id="play-pops">
        <view id="play-pop-bg" wx:if="showPop" bind:tap="hidePop"></view>
        <!--玩法介绍-->
        <pop-play-intro wx:if="{{showPlayIntro}}" bind:hide="hidePop"></pop-play-intro>
        <!--普通事件-->
        <pop-event-normal wx:if="{{showEventNormal}}" bind:hide="hidePop"></pop-event-normal>
        <!--答题事件-->
        <pop-event-quest wx:if="{{showEventQuest}}" bind:hide="hidePop"></pop-event-quest>
        <!--首次免费租赁-->
        <pop-free-rent wx:if="{{showFreeRent}}" bind:hide="hidePop"></pop-free-rent>
        <!--获得明信片-->
        <pop-got-post wx:if="{{showGotPost}}" bind:hide="hidePop"></pop-got-post>
        <!--任务信息-->
        <pop-mission-info wx:if="{{showMissionInfo}}" bind:hide="hidePop"></pop-mission-info>
    </view>
</view>
<guide wx:if="{{!hasPlay}}" bindplayed='played'></guide>

